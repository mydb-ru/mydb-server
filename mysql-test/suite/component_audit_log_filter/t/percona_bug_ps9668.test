#
# PS-9668: Executing LOCK TABLES FOR BACKUP after enabling audit logs crashes the server
#
--source include/have_component_audit_log.inc
--source include/have_debug.inc
--source ../inc/audit_tables_init.inc
--source ../inc/audit_comp_install.inc

SELECT audit_log_filter_set_filter('log_all', '{"filter": {"log": true}}');
SELECT audit_log_filter_set_user('%', 'log_all');

--echo # LOCK TABLES FOR BACKUP should not cause server crash.
LOCK TABLES FOR BACKUP;
UNLOCK TABLES;

--echo #
--echo # Cleanup
--source ../inc/audit_comp_uninstall.inc
--source ../inc/audit_tables_cleanup.inc
